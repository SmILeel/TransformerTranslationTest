Modified from some open sourced projects.
